{"version":3,"sources":["webpack:///./Modules/Catering/Resources/assets/js/views/preparation/PreparationCrud.vue?ff3c","webpack:///Modules/Catering/Resources/assets/js/views/preparation/PreparationCrud.vue","webpack:///./Modules/Catering/Resources/assets/js/views/preparation/PreparationCrud.vue?ad50","webpack:///./Modules/Catering/Resources/assets/js/views/preparation/PreparationCrud.vue"],"names":["action","component","_vm","this","_h","$createElement","_c","_self","attrs","model","value","callback","$$v","dialog","expression","staticClass","_v","_s","icon","titleForm","meta","preparation_types","form","errors","has","get","$set","ref","orderedSupplies","on","addSupply","searchedSupply","supplyHeaders","preparation_details","scopedSlots","_u","key","fn","item","index","unit_abrev","$event","removeSupply","domProps","_e","saving","closeForm","id","submit","title","openForm","staticStyle","warehouses","filter","getItems","headers","dataItems","data","loading","roles","map","r","name","toString","last_page"],"mappings":"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","file":"1.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-dialog',{attrs:{\"scrollable\":\"\",\"persistent\":\"\",\"max-width\":\"600\"},model:{value:(_vm.dialog),callback:function ($$v) {_vm.dialog=$$v},expression:\"dialog\"}},[_c('v-card',[_c('v-card-title',[_c('span',{staticClass:\"headline\"},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(_vm._s(_vm.icon))]),_vm._v(\"\\n                    \"+_vm._s(_vm.titleForm)+\"\\n                \")],1)]),_vm._v(\" \"),_c('v-divider'),_vm._v(\" \"),_c('v-card-text',{staticClass:\"pt-5\"},[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"6\"}},[_c('v-select',{attrs:{\"dense\":\"\",\"outlined\":\"\",\"items\":_vm.meta.preparation_types,\"label\":\"Tipo de preparacion*\",\"item-value\":\"id\",\"item-text\":\"descrip\",\"hide-details\":\"auto\",\"error\":_vm.form.errors.has('preparation_type_id'),\"error-messages\":_vm.form.errors.get('preparation_type_id')},model:{value:(_vm.form.preparation_type_id),callback:function ($$v) {_vm.$set(_vm.form, \"preparation_type_id\", $$v)},expression:\"form.preparation_type_id\"}})],1),_vm._v(\" \"),_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"6\"}},[_c('v-text-field',{attrs:{\"outlined\":\"\",\"dense\":\"\",\"label\":\"Descripcion*\",\"hide-details\":\"auto\",\"error\":_vm.form.errors.has('descrip'),\"error-messages\":_vm.form.errors.get('descrip')},model:{value:(_vm.form.descrip),callback:function ($$v) {_vm.$set(_vm.form, \"descrip\", $$v)},expression:\"form.descrip\"}})],1),_vm._v(\" \"),_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"12\"}},[_c('v-card',[_c('v-toolbar',{staticClass:\"elevation-1\"},[_c('v-autocomplete',{ref:\"autocompleteSupply\",attrs:{\"dense\":\"\",\"single-line\":\"\",\"items\":_vm.orderedSupplies,\"label\":\"Agregar insumo\",\"item-text\":\"name\",\"return-object\":\"\",\"hide-details\":\"auto\"},on:{\"change\":_vm.addSupply},model:{value:(_vm.searchedSupply),callback:function ($$v) {_vm.searchedSupply=$$v},expression:\"searchedSupply\"}})],1),_vm._v(\" \"),_c('v-data-table',{attrs:{\"dense\":\"\",\"headers\":_vm.supplyHeaders,\"items\":_vm.form.preparation_details,\"disable-sort\":\"\",\"disable-pagination\":\"\",\"hide-default-footer\":\"\"},scopedSlots:_vm._u([{key:\"item.amount\",fn:function(ref){\nvar item = ref.item;\nvar index = ref.index;\nreturn [_c('v-text-field',{attrs:{\"dense\":\"\",\"type\":\"number\",\"min\":\"0\",\"suffix\":item.unit_abrev,\"hide-details\":\"auto\",\"error\":_vm.form.errors.has((\"preparation_details.\" + index + \".amount\")),\"title\":_vm.form.errors.has((\"preparation_details.\" + index + \".amount\"))? _vm.form.errors.get((\"preparation_details.\" + index + \".amount\")): null},model:{value:(item.amount),callback:function ($$v) {_vm.$set(item, \"amount\", $$v)},expression:\"item.amount\"}})]}},{key:\"item.action\",fn:function(ref){\nvar item = ref.item;\nvar index = ref.index;\nreturn [_c('v-icon',{staticClass:\"mr-2\",attrs:{\"small\":\"\"},on:{\"click\":function($event){return _vm.removeSupply(item, index)}}},[_vm._v(\"\\n                                        mdi-delete\\n                                    \")])]}}],null,true)}),_vm._v(\" \"),(_vm.form.errors.has('preparation_details'))?_c('small',{staticClass:\"error--text px-3\",domProps:{\"innerHTML\":_vm._s(_vm.form.errors.get('preparation_details'))}}):_vm._e()],1)],1)],1),_vm._v(\" \"),_c('small',[_vm._v(\"*Campos requeridos\")])],1),_vm._v(\" \"),_c('v-divider'),_vm._v(\" \"),_c('v-card-actions',[_c('v-spacer'),_vm._v(\" \"),_c('v-btn',{attrs:{\"text\":\"\",\"disabled\":_vm.saving},on:{\"click\":_vm.closeForm}},[_vm._v(\"close\")]),_vm._v(\" \"),(!_vm.form.id)?_c('v-btn',{attrs:{\"text\":\"\",\"color\":\"primary\",\"disabled\":_vm.saving},on:{\"click\":function($event){return _vm.submit('create')}}},[_vm._v(\"Crear\")]):_vm._e(),_vm._v(\" \"),(_vm.form.id)?_c('v-btn',{attrs:{\"text\":\"\",\"color\":\"error\",\"disabled\":_vm.saving},on:{\"click\":function($event){return _vm.submit('delete')}}},[_vm._v(\"Eliminar\")]):_vm._e(),_vm._v(\" \"),(_vm.form.id)?_c('v-btn',{attrs:{\"text\":\"\",\"color\":\"success\",\"disabled\":_vm.saving},on:{\"click\":function($event){return _vm.submit('edit')}}},[_vm._v(\"Editar\")]):_vm._e()],1)],1)],1),_vm._v(\" \"),_c('v-card',[_c('v-card-title',[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(_vm._s(_vm.icon))]),_vm._v(\"\\n            \"+_vm._s(_vm.title)+\"\\n            \"),_c('v-btn',{staticClass:\"ml-3\",attrs:{\"x-small\":\"\",\"fab\":\"\",\"elevation\":\"1\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.openForm()}}},[_c('v-icon',[_vm._v(\"mdi-plus\")])],1),_vm._v(\" \"),_c('v-spacer'),_vm._v(\" \"),_c('v-select',{staticStyle:{\"width\":\"200px\"},attrs:{\"dense\":\"\",\"items\":_vm.meta.warehouses,\"single-line\":\"\",\"label\":\"Almacen*\",\"item-value\":\"id\",\"item-text\":\"name\",\"hide-details\":\"auto\",\"error\":_vm.filter.errors.has('warehouse_id'),\"error-messages\":_vm.filter.errors.get('warehouse_id')},model:{value:(_vm.filter.warehouse_id),callback:function ($$v) {_vm.$set(_vm.filter, \"warehouse_id\", $$v)},expression:\"filter.warehouse_id\"}})],1),_vm._v(\" \"),_c('v-card-text',[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"6\"}},[_c('v-text-field',{attrs:{\"dense\":\"\",\"type\":\"search\",\"append-icon\":\"mdi-magnify\",\"label\":\"Buscar\",\"single-line\":\"\",\"hide-details\":\"\"},on:{\"click:append\":_vm.getItems,\"search\":_vm.getItems},model:{value:(_vm.filter.search),callback:function ($$v) {_vm.$set(_vm.filter, \"search\", $$v)},expression:\"filter.search\"}})],1)],1)],1),_vm._v(\" \"),_c('v-data-table',{attrs:{\"dense\":\"\",\"headers\":_vm.headers,\"items\":_vm.dataItems.data,\"loading\":_vm.loading,\"disable-sort\":\"\",\"disable-pagination\":\"\",\"hide-default-footer\":\"\"},scopedSlots:_vm._u([{key:\"item.roles\",fn:function(ref){\nvar item = ref.item;\nreturn [_vm._v(\"\\n                \"+_vm._s(item.roles.map( function (r) { return r.name; }).toString())+\"\\n            \")]}},{key:\"item.action\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-icon',{staticClass:\"mr-2\",attrs:{\"small\":\"\"},on:{\"click\":function($event){return _vm.openForm(item)}}},[_vm._v(\"\\n                    mdi-pencil\\n                \")])]}}],null,true)}),_vm._v(\" \"),_c('v-card-actions',[_c('v-row',[_c('v-col',{staticClass:\"text-center\",attrs:{\"cols\":\"12\"}},[_c('v-pagination',{attrs:{\"length\":_vm.dataItems.meta.last_page,\"total-visible\":7},on:{\"input\":_vm.getItems},model:{value:(_vm.dataItems.meta.current_page),callback:function ($$v) {_vm.$set(_vm.dataItems.meta, \"current_page\", $$v)},expression:\"dataItems.meta.current_page\"}})],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div>\r\n        <!-- Form -->\r\n        <v-dialog\r\n            v-model=\"dialog\"\r\n            scrollable\r\n            persistent\r\n            max-width=\"600\"\r\n        >\r\n            <v-card>\r\n                <v-card-title>\r\n                    <span class=\"headline\">\r\n                        <v-icon left>{{icon}}</v-icon>\r\n                        {{ titleForm }}\r\n                    </span>\r\n                </v-card-title>\r\n                <v-divider></v-divider>\r\n                <v-card-text class=\"pt-5\">\r\n                    <v-row>\r\n                        <!-- preparation_type_id -->\r\n                        <v-col cols=\"12\" sm=\"6\">\r\n                            <v-select dense outlined\r\n                                v-model=\"form.preparation_type_id\"\r\n                                :items=\"meta.preparation_types\"\r\n                                label=\"Tipo de preparacion*\"\r\n                                item-value=\"id\"\r\n                                item-text=\"descrip\"\r\n                                hide-details=\"auto\"\r\n                                :error=\"form.errors.has('preparation_type_id')\"\r\n                                :error-messages=\"form.errors.get('preparation_type_id')\"\r\n                            ></v-select>\r\n                        </v-col>\r\n\r\n                        <!-- descrip -->\r\n                        <v-col cols=\"12\" sm=\"6\">\r\n                            <v-text-field outlined dense\r\n                                v-model=\"form.descrip\"\r\n                                label=\"Descripcion*\"\r\n                                hide-details=\"auto\"\r\n                                :error=\"form.errors.has('descrip')\"\r\n                                :error-messages=\"form.errors.get('descrip')\"\r\n                            ></v-text-field>\r\n                        </v-col>\r\n\r\n                        <!-- preparation_details -->\r\n                        <v-col cols=\"12\" sm=\"12\">\r\n                            <v-card>\r\n                                <v-toolbar class=\"elevation-1\">\r\n                                    <v-autocomplete dense single-line\r\n                                        ref=\"autocompleteSupply\"\r\n                                        v-model=\"searchedSupply\"\r\n                                        :items=\"orderedSupplies\"\r\n                                        label=\"Agregar insumo\"\r\n                                        item-text=\"name\"\r\n                                        return-object\r\n                                        hide-details=\"auto\"\r\n                                        @change=\"addSupply\"\r\n                                    ></v-autocomplete>\r\n                                </v-toolbar>\r\n\r\n                                <v-data-table dense\r\n                                    :headers=\"supplyHeaders\"\r\n                                    :items=\"form.preparation_details\"\r\n                                    disable-sort\r\n                                    disable-pagination\r\n                                    hide-default-footer\r\n                                >\r\n                                    <!-- quantity -->\r\n                                    <template v-slot:[`item.amount`]=\"{ item, index }\">\r\n                                        <v-text-field dense type=\"number\" min=\"0\"\r\n                                            v-model=\"item.amount\"\r\n                                            :suffix=\"item.unit_abrev\"\r\n                                            hide-details=\"auto\"\r\n                                            :error=\"form.errors.has(`preparation_details.${index}.amount`)\"\r\n                                            :title=\"form.errors.has(`preparation_details.${index}.amount`)? form.errors.get(`preparation_details.${index}.amount`): null\"\r\n                                        ></v-text-field>\r\n                                    </template>\r\n\r\n                                    <template v-slot:[`item.action`]=\"{ item, index }\">\r\n                                        <v-icon\r\n                                            small\r\n                                            class=\"mr-2\"\r\n                                            @click=\"removeSupply(item, index)\"\r\n                                        >\r\n                                            mdi-delete\r\n                                        </v-icon>\r\n                                    </template>\r\n                                </v-data-table>\r\n\r\n                                <small class=\"error--text px-3\"\r\n                                    v-if=\"form.errors.has('preparation_details')\"\r\n                                    v-html=\"form.errors.get('preparation_details')\"\r\n                                ></small>\r\n                            </v-card>\r\n                        </v-col>\r\n\r\n                    </v-row>\r\n                    <small>*Campos requeridos</small>\r\n                </v-card-text>\r\n                <v-divider></v-divider>\r\n                <v-card-actions>\r\n                    <v-spacer></v-spacer>\r\n                    <v-btn text @click=\"closeForm\" :disabled=\"saving\">close</v-btn>\r\n                    <v-btn text color=\"primary\" @click=\"submit('create')\" v-if=\"!form.id\" :disabled=\"saving\">Crear</v-btn>\r\n                    <v-btn text color=\"error\" @click=\"submit('delete')\" v-if=\"form.id\" :disabled=\"saving\">Eliminar</v-btn>\r\n                    <v-btn text color=\"success\" @click=\"submit('edit')\" v-if=\"form.id\" :disabled=\"saving\">Editar</v-btn>\r\n                </v-card-actions>\r\n            </v-card>\r\n        </v-dialog>\r\n\r\n        <!-- table -->\r\n        <v-card>\r\n            <v-card-title>\r\n                <v-icon left>{{icon}}</v-icon>\r\n                {{ title }}\r\n                <v-btn x-small fab elevation=\"1\"\r\n                    class=\"ml-3\"\r\n                    color=\"primary\" \r\n                    \r\n                    @click=\"openForm()\"\r\n                ><v-icon>mdi-plus</v-icon></v-btn>\r\n\r\n                <v-spacer></v-spacer>\r\n                <v-select dense style=\"width:200px;\"\r\n                    v-model=\"filter.warehouse_id\"\r\n                    :items=\"meta.warehouses\"\r\n                    single-line\r\n                    label=\"Almacen*\"\r\n                    item-value=\"id\"\r\n                    item-text=\"name\"\r\n                    hide-details=\"auto\"\r\n                    :error=\"filter.errors.has('warehouse_id')\"\r\n                    :error-messages=\"filter.errors.get('warehouse_id')\"\r\n                ></v-select>\r\n            </v-card-title>\r\n\r\n            <v-card-text>\r\n                <v-row>\r\n                    <v-col cols=\"12\" sm=\"6\">\r\n                        <v-text-field dense\r\n                            type=\"search\"\r\n                            v-model=\"filter.search\"\r\n                            append-icon=\"mdi-magnify\"\r\n                            label=\"Buscar\"\r\n                            single-line\r\n                            hide-details\r\n                            @click:append=\"getItems\"\r\n                            @search=\"getItems\"\r\n                        ></v-text-field>\r\n                    </v-col>\r\n                </v-row>\r\n            </v-card-text>\r\n\r\n            <v-data-table dense\r\n                :headers=\"headers\"\r\n                :items=\"dataItems.data\"\r\n                :loading=\"loading\"\r\n                disable-sort\r\n                disable-pagination\r\n                hide-default-footer\r\n            >\r\n                <template v-slot:[`item.roles`]=\"{ item }\">\r\n                    {{ item.roles.map( r => r.name).toString() }}\r\n                </template>\r\n                <template v-slot:[`item.action`]=\"{ item }\">\r\n                    <v-icon\r\n                        small\r\n                        class=\"mr-2\"\r\n                        @click=\"openForm(item)\"\r\n                    >\r\n                        mdi-pencil\r\n                    </v-icon>\r\n                </template>\r\n            </v-data-table>\r\n\r\n            <v-card-actions>\r\n                <v-row>\r\n                    <v-col cols=\"12\" class=\"text-center\">\r\n                        <v-pagination\r\n                            v-model=\"dataItems.meta.current_page\"\r\n                            :length=\"dataItems.meta.last_page\"\r\n                            :total-visible=\"7\"\r\n                            @input=\"getItems\"\r\n                        ></v-pagination>\r\n                    </v-col>\r\n                </v-row>\r\n            </v-card-actions>\r\n        </v-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data () {\r\n        return {\r\n            icon: 'mdi-tag',\r\n            resource: 'catering/preparations',\r\n            title: 'Preparaciones',\r\n            titleForm: 'Preparacion',\r\n            dialog: false,\r\n            loading: false,\r\n            saving: false,\r\n            searchedSupply: null,\r\n\r\n            filter: new Form({\r\n                warehouse_id: this.$store.getters.warehouseId,\r\n                search: null,\r\n            }),\r\n\r\n            form: new Form({\r\n                id: null,\r\n                descrip: null,\r\n                preparation_type_id: null,\r\n                warehouse_id: null, \r\n                preparation_details: [],\r\n            }),\r\n\r\n            headers: [\r\n                { text: 'ID', value: 'id' },\r\n                { text: 'Descripcion', value: 'descrip' },\r\n                { text: 'Tipo', value: 'preparation_type.descrip' },\r\n                { text: 'Accion', value: 'action', sortable: false },\r\n            ],\r\n\r\n            supplyHeaders: [\r\n                { text: 'Insumo', value: 'supply_name' },\r\n                { text: 'Cantidad', value: 'amount', width: \"150\" },\r\n                { text: 'Accion', value: 'action', sortable: false },\r\n            ],\r\n\r\n            dataItems: { meta: {}, data: [] },\r\n\r\n            meta: { preparation_types: [], supplies: [], units: [], warehouses: [] },\r\n        }\r\n    },\r\n\r\n    computed: {\r\n        orderedSupplies() {\r\n            return this.meta.supplies.sort((a, b) => a.name.localeCompare(b.name) );\r\n        },\r\n\r\n        filteredItems() \r\n        {\r\n            return this.items.filter( item => {\r\n                let matchType = this.filter.preparation_type==null? true: this.filter.preparation_type.id===item.preparation_type_id\r\n                let matchWarehouse = this.filter.warehouse==null? true: this.filter.warehouse.id===item.warehouse_id\r\n                return matchType && matchWarehouse\r\n            })\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.getMeta();\r\n        this.getItems();\r\n    },\r\n\r\n    methods: {\r\n\r\n        getUnitDefault( unitType ){\r\n            //1: unidad, 2: kilo, 3: litro\r\n            let unitDefault = JSON.stringify(this.meta.units.find(x => x.id==unitType))\r\n            return unitDefault==null? {}: JSON.parse(unitDefault)\r\n        },\r\n\r\n        addSupply(){\r\n            const foundSupply = this.form.preparation_details.find(pd => pd.supply_id === this.searchedSupply.id)\r\n\r\n            if( typeof foundSupply !== 'undefined') {\r\n                this.$refs['autocompleteSupply'].reset();\r\n                this.$toast('EL insumo ya ha sido agregado', 'warning', 1000)\r\n                return\r\n            }\r\n\r\n            const newSupply = JSON.parse(JSON.stringify(this.searchedSupply))\r\n\r\n            const baseUnit = this.getUnitDefault(newSupply.unit_type)\r\n\r\n            this.form.preparation_details.push({\r\n                supply_name: newSupply.name,\r\n                supply_id: newSupply.id,\r\n                unit_id: baseUnit.id,\r\n                unit_abrev: baseUnit.abrev,\r\n                amount: 0,\r\n            })\r\n            this.$refs['autocompleteSupply'].reset();\r\n        },\r\n\r\n        removeSupply(supply, index) {\r\n            this.form.preparation_details.splice(index, 1)\r\n        },\r\n\r\n        openForm(item = null) {\r\n            this.form.clear()\r\n            this.form.reset()\r\n            if (item !== null) {\r\n                this.form.fill(JSON.parse(JSON.stringify(item)))\r\n            }else {\r\n                if( !this.filter.warehouse_id ){\r\n                    this.$toast('Seleccione un almacen', 'warning')\r\n                    return;\r\n                }\r\n                this.form.warehouse_id = this.filter.warehouse_id;\r\n            }\r\n            this.dialog = true\r\n        },\r\n\r\n        closeForm() {\r\n            this.dialog = false\r\n        },\r\n\r\n        async getMeta() {\r\n            try {\r\n                const params = { service: `get-meta-crud-preparations` }\r\n                const {data} = await this.form.get(`/common`, {params})\r\n                this.meta = data\r\n            } catch (error) {\r\n                this.$toast(params.service, 'danger')\r\n            }\r\n        },\r\n\r\n        async getItems( page=1 ) {\r\n            try {\r\n                this.dataItems = { meta: {}, data: [] },\r\n                this.loading = true\r\n                const params = { \r\n                    page: page,\r\n                    warehouse_id: this.filter.warehouse_id,\r\n                    search: this.filter.search\r\n                }\r\n                const { data }  = await this.filter.get(`/${this.resource}`, {params})\r\n                this.dataItems = data\r\n            } catch (error) {\r\n                this.$toast(error.message, 'danger')\r\n            } finally {\r\n                this.loading = false\r\n            }\r\n        },\r\n\r\n        async submit(action = 'create') {\r\n            try {\r\n                this.form.clear()\r\n                this.saving = true\r\n                const itemIndex = this.dataItems.data.findIndex(x => x.id===this.form.id)\r\n\r\n                if( action==='delete' && !confirm(\"Â¿Realmente desea eliminar el registro?\") ){\r\n                    this.dialog = false\r\n                    return\r\n                }\r\n\r\n                const { data } = await this.form.req(`/${this.resource}`, action)\r\n\r\n                if (action === 'create') {\r\n                    this.$toast('registro creado!', 'success')\r\n                    this.filter.search = data.descrip\r\n                    this.getItems()\r\n                }\r\n                if (action === 'edit') {\r\n                    this.$toast('registro actualizado!', 'success')\r\n                    this.dataItems.data.splice(itemIndex, 1, data)\r\n                }\r\n                if (action === 'delete') {\r\n                    this.$toast('registro eliminado!', 'success')\r\n                    this.getItems()\r\n                }\r\n                this.dialog = false\r\n            } catch (error) {\r\n                if (error.response && error.response.status !== 422) {\r\n                    this.$toast(error.message, 'danger')\r\n                }\r\n            } finally {\r\n                this.saving = false\r\n            }\r\n        },\r\n    },\r\n\r\n}\r\n</script>","import mod from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreparationCrud.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreparationCrud.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PreparationCrud.vue?vue&type=template&id=8cc473cc&\"\nimport script from \"./PreparationCrud.vue?vue&type=script&lang=js&\"\nexport * from \"./PreparationCrud.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}